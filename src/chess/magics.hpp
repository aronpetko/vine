#ifndef PRECOMPUTED_HPP
#define PRECOMPUTED_HPP

#include "../util/types.hpp"
#include "../util/multi_array.hpp"
#include "bitboard.hpp"

struct MagicEntry {
    u64 mask;
    u64 magic;
    i32 shift;
};

// clang-format off
constexpr std::array<MagicEntry, 64> ROOK_MAGICS = {
    MagicEntry{0x000101010101017eull, 0x2480001240002088ull, 52},
    MagicEntry{0x000202020202027cull, 0x0040002000405000ull, 53},
    MagicEntry{0x000404040404047aull, 0x2080088010012001ull, 53},
    MagicEntry{0x0008080808080876ull, 0x0080049001080080ull, 53},
    MagicEntry{0x001010101010106eull, 0x0b00020800945100ull, 53},
    MagicEntry{0x002020202020205eull, 0x04800a0080211400ull, 53},
    MagicEntry{0x004040404040403eull, 0xc0801a0000800100ull, 53},
    MagicEntry{0x008080808080807eull, 0x0600084300802204ull, 52},
    MagicEntry{0x0001010101017e00ull, 0x4240800140006080ull, 53},
    MagicEntry{0x0002020202027c00ull, 0x0889002080400111ull, 54},
    MagicEntry{0x0004040404047a00ull, 0x4823004210200100ull, 54},
    MagicEntry{0x0008080808087600ull, 0xa000808008001000ull, 54},
    MagicEntry{0x0010101010106e00ull, 0x0020800800340082ull, 54},
    MagicEntry{0x0020202020205e00ull, 0x004100040039004eull, 54},
    MagicEntry{0x0040404040403e00ull, 0x0802003408150200ull, 54},
    MagicEntry{0x0080808080807e00ull, 0x0800800080104100ull, 53},
    MagicEntry{0x00010101017e0100ull, 0x0040008002245080ull, 53},
    MagicEntry{0x00020202027c0200ull, 0x0030004003402000ull, 54},
    MagicEntry{0x00040404047a0400ull, 0x2400110042600100ull, 54},
    MagicEntry{0x0008080808760800ull, 0xa000808008001000ull, 54},
    MagicEntry{0x00101010106e1000ull, 0x0123030004080010ull, 54},
    MagicEntry{0x00202020205e2000ull, 0x10c0808012000400ull, 54},
    MagicEntry{0x00404040403e4000ull, 0x0200040022080110ull, 54},
    MagicEntry{0x00808080807e8000ull, 0x028a420000a10844ull, 53},
    MagicEntry{0x000101017e010100ull, 0x8040028480014021ull, 53},
    MagicEntry{0x000202027c020200ull, 0x0841006d00400082ull, 54},
    MagicEntry{0x000404047a040400ull, 0x0803004300146004ull, 54},
    MagicEntry{0x0008080876080800ull, 0x0000500280080080ull, 54},
    MagicEntry{0x001010106e101000ull, 0x0806140080080081ull, 54},
    MagicEntry{0x002020205e202000ull, 0x0014820080800400ull, 54},
    MagicEntry{0x004040403e404000ull, 0x1004084400021001ull, 54},
    MagicEntry{0x008080807e808000ull, 0x0800800080104100ull, 53},
    MagicEntry{0x0001017e01010100ull, 0x0080800301002041ull, 53},
    MagicEntry{0x0002027c02020200ull, 0x0030004003402000ull, 54},
    MagicEntry{0x0004047a04040400ull, 0x9200502001004102ull, 54},
    MagicEntry{0x0008087608080800ull, 0x0c0200100a004020ull, 54},
    MagicEntry{0x0010106e10101000ull, 0x0141018801001004ull, 54},
    MagicEntry{0x0020205e20202000ull, 0x2248040080801a00ull, 54},
    MagicEntry{0x0040403e40404000ull, 0x0000100804000201ull, 54},
    MagicEntry{0x0080807e80808000ull, 0x0806004086002514ull, 53},
    MagicEntry{0x00017e0101010100ull, 0x10807880c0008000ull, 53},
    MagicEntry{0x00027c0202020200ull, 0x0800200250004002ull, 54},
    MagicEntry{0x00047a0404040400ull, 0x0102100020008080ull, 54},
    MagicEntry{0x0008760808080800ull, 0x8200300021010009ull, 54},
    MagicEntry{0x00106e1010101000ull, 0x6280040801010010ull, 54},
    MagicEntry{0x00205e2020202000ull, 0x0020844010280120ull, 54},
    MagicEntry{0x00403e4040404000ull, 0x00000a0108040010ull, 54},
    MagicEntry{0x00807e8080808000ull, 0x0000040260820001ull, 53},
    MagicEntry{0x007e010101010100ull, 0x0040008002245080ull, 53},
    MagicEntry{0x007c020202020200ull, 0x0010600092c00b80ull, 54},
    MagicEntry{0x007a040404040400ull, 0x8006900188200080ull, 54},
    MagicEntry{0x0076080808080800ull, 0x0080601202084200ull, 54},
    MagicEntry{0x006e101010101000ull, 0x4424008115880080ull, 54},
    MagicEntry{0x005e202020202000ull, 0x0002000408308600ull, 54},
    MagicEntry{0x003e404040404000ull, 0x0100080201100400ull, 54},
    MagicEntry{0x007e808080808000ull, 0x008005025c940a00ull, 53},
    MagicEntry{0x7e01010101010100ull, 0x0220409300208001ull, 52},
    MagicEntry{0x7c02020202020200ull, 0x8002400980241101ull, 53},
    MagicEntry{0x7a04040404040400ull, 0x5402005280200842ull, 53},
    MagicEntry{0x7608080808080800ull, 0x3801000850000423ull, 53},
    MagicEntry{0x6e10101010101000ull, 0x300a002008043142ull, 53},
    MagicEntry{0x5e20202020202000ull, 0x1009000400220821ull, 53},
    MagicEntry{0x3e40404040404000ull, 0x9240028810012224ull, 53},
    MagicEntry{0x7e80808080808000ull, 0x0001940028410092ull, 52}
};

constexpr std::array<MagicEntry, 64> BISHOP_MAGICS = {
    MagicEntry{0x0040201008040200ull, 0x0040440812022420ull, 58},
    MagicEntry{0x0000402010080400ull, 0x3209080800504480ull, 59},
    MagicEntry{0x0000004020100a00ull, 0x401000a189000040ull, 59},
    MagicEntry{0x0000000040221400ull, 0x2104070200108490ull, 59},
    MagicEntry{0x0000000002442800ull, 0x4004242000403041ull, 59},
    MagicEntry{0x0000000204085000ull, 0x0001012010880821ull, 59},
    MagicEntry{0x0000020408102000ull, 0x242108084a490101ull, 59},
    MagicEntry{0x0002040810204000ull, 0x200202b108080400ull, 58},
    MagicEntry{0x0020100804020000ull, 0x0000044448020400ull, 59},
    MagicEntry{0x0040201008040000ull, 0xc200088808208020ull, 59},
    MagicEntry{0x00004020100a0000ull, 0x0000105182810000ull, 59},
    MagicEntry{0x0000004022140000ull, 0x180078204c400000ull, 59},
    MagicEntry{0x0000000244280000ull, 0x0001060a10005040ull, 59},
    MagicEntry{0x0000020408500000ull, 0x00c0950120100000ull, 59},
    MagicEntry{0x0002040810200000ull, 0x0000050110026100ull, 59},
    MagicEntry{0x0004081020400000ull, 0x200202b108080400ull, 59},
    MagicEntry{0x0010080402000200ull, 0x4808000410640820ull, 59},
    MagicEntry{0x0020100804000400ull, 0x10200a0206020e00ull, 59},
    MagicEntry{0x004020100a000a00ull, 0x1002001003220020ull, 57},
    MagicEntry{0x0000402214001400ull, 0x0808000082004000ull, 57},
    MagicEntry{0x0000024428002800ull, 0x2001001820280200ull, 57},
    MagicEntry{0x0002040850005000ull, 0x1101008201030552ull, 57},
    MagicEntry{0x0004081020002000ull, 0x0151000245082000ull, 59},
    MagicEntry{0x0008102040004000ull, 0x0001001024032462ull, 59},
    MagicEntry{0x0008040200020400ull, 0x4820042010942810ull, 59},
    MagicEntry{0x0010080400040800ull, 0x00a8210082040900ull, 59},
    MagicEntry{0x0020100a000a1000ull, 0x8180a08010010040ull, 57},
    MagicEntry{0x0040221400142200ull, 0xc24004002a010810ull, 55},
    MagicEntry{0x0002442800284400ull, 0x0003001001004012ull, 55},
    MagicEntry{0x0004085000500800ull, 0x0010038022405020ull, 57},
    MagicEntry{0x0008102000201000ull, 0x01042100040a8200ull, 59},
    MagicEntry{0x0010204000402000ull, 0x0000444049040200ull, 59},
    MagicEntry{0x0004020002040800ull, 0x2001101000882008ull, 59},
    MagicEntry{0x0008040004081000ull, 0x0158026600580800ull, 59},
    MagicEntry{0x00100a000a102000ull, 0x4001680804440061ull, 57},
    MagicEntry{0x0022140014224000ull, 0x4000400a00042200ull, 55},
    MagicEntry{0x0044280028440200ull, 0x0000420021020080ull, 55},
    MagicEntry{0x0008500050080400ull, 0x0010020020020080ull, 57},
    MagicEntry{0x0010200020100800ull, 0x5008010040210800ull, 59},
    MagicEntry{0x0020400040201000ull, 0x000604002001108cull, 59},
    MagicEntry{0x0002000204081000ull, 0x0808010920050821ull, 59},
    MagicEntry{0x0004000408102000ull, 0x4000c41220020800ull, 59},
    MagicEntry{0x000a000a10204000ull, 0x4000804040400808ull, 57},
    MagicEntry{0x0014001422400000ull, 0x0000814200809802ull, 57},
    MagicEntry{0x0028002844020000ull, 0x0000080104020041ull, 57},
    MagicEntry{0x0050005008040200ull, 0x0414010c42000101ull, 57},
    MagicEntry{0x0020002010080400ull, 0x3209080800504480ull, 59},
    MagicEntry{0x0040004020100800ull, 0x8031050202000280ull, 59},
    MagicEntry{0x0000020408102000ull, 0x242108084a490101ull, 59},
    MagicEntry{0x0000040810204000ull, 0x082080481a101000ull, 59},
    MagicEntry{0x00000a1020400000ull, 0x4000004a00902042ull, 59},
    MagicEntry{0x0000142240000000ull, 0x0100218108480800ull, 59},
    MagicEntry{0x0000284402000000ull, 0x0c28201202020840ull, 59},
    MagicEntry{0x0000500804020000ull, 0x0c28201202020840ull, 59},
    MagicEntry{0x0000201008040200ull, 0x0424040408020088ull, 59},
    MagicEntry{0x0000402010080400ull, 0x3209080800504480ull, 59},
    MagicEntry{0x0002040810204000ull, 0x200202b108080400ull, 58},
    MagicEntry{0x0004081020400000ull, 0x200202b108080400ull, 59},
    MagicEntry{0x000a102040000000ull, 0x0034c00448441005ull, 59},
    MagicEntry{0x0014224000000000ull, 0x0000810850208802ull, 59},
    MagicEntry{0x0028440200000000ull, 0x02000808403d0101ull, 59},
    MagicEntry{0x0050080402000000ull, 0x0000801006900108ull, 59},
    MagicEntry{0x0020100804020000ull, 0x0000044448020400ull, 59},
    MagicEntry{0x0040201008040200ull, 0x0040440812022420ull, 58}
};
// clang-format on

extern MultiArray<Bitboard, 64, 512> BISHOP_ATTACKS;
extern MultiArray<Bitboard, 64, 4096> ROOK_ATTACKS;

[[nodiscard]] u32 get_bishop_attack_idx(Square sq, Bitboard occ);
[[nodiscard]] u32 get_rook_attack_idx(Square sq, Bitboard occ);

#endif // PRECOMPUTED_HPP